TRIPOLI (Reuters) - An armed group attacked Libya’s largest oilfield on Monday, but was repelled after clashes with its protection force, while fighting escalated in eastern commander Khalifa Haftar’s effort to capture the capital Tripoli. The state oil company National Oil Corporation (NOC) said unknown gunmen fired a rocket propelled grenade at a control station of the El Sharara oilfield. Guards at the site eventually repelled the attackers, an oil engineer there told Reuters. There were no casualties among oil workers and production was unaffected, the NOC said in a statement. OPEC member Libya’s oil output has been repeatedly disrupted by factional conflict and blockades since the 2011 uprising that toppled longtime dictator Muammar Gaddafi. Haftar’s three-week-old offensive to seize Tripoli, seat of Libya’s internationally recognized government, has sharpened a power struggle that has fractured Libya since Gaddafi’s fall.  The assault by the Haftar-led Libyan National Army (LNA), which is allied to a parallel government based in the eastern city of Benghazi, stalled on Tripoli’s stoutly defended southern outskirts last week. But fighting intensified again on Monday, with both sides using artillery. Shelling was heard in the center of Tripoli coming from southern districts from morning until late at night, residents said. The Tripoli forces as well as the LNA claimed to have made progress on different parts of the frontline though the situation remained fluid. A prominent commander from Misrata, a western city allied to Tripoli, has died, the LNA and some websites affiliated with armed groups in Misrata said.  No official confirmation was immediately available. The battle for Tripoli has killed at least 345 people, including 22 civilians, a World Health Organization official said on Monday. A hospital in Tripoli was evacuated after shelling shattered some windows, the official tweeted. The United Nations’ refugee agency UNHCR said 146 refugees, mainly Africans and a handful of Syrians, were evacuated on Monday from Libya to Italy, where their asylum claims will be processed. Most of them had been transferred earlier this month from detention centers near the fighting, a spokeswoman said. But 3,300 migrants and refugees remain trapped in detention centers near the Tripoli clashes, the UNHCR said. It was unclear who the gunmen who targeted El Sharara are affiliated with. The oilfield is in a southwestern region held by forces loyal to Haftar.  State guards and local tribesmen shut down El Sharara in December to press financial demands before allowing production to reopen in March.  The field, operated by the NOC and foreign partners, has been pumping crude only intermittently due to blockades mostly by armed groups and other incidents. U.N. officials say Haftar is backed militarily by the United Arab Emirates and Egypt, which want to build him up to help fight and neutralize Islamist militants in the region. His opponents see him as a budding autocrat in Gaddafi’s mold. Divisions among European and Gulf nations over how to deal with Haftar have scuppered U.N. efforts to broker a ceasefire between the main factions to prepare Libya for elections to help reunify the North African country. France and the United States been accused by Prime Minister Fayez al-Serraj’s government in Tripoli of playing both sides since Haftar launched his offensive. Paris has backed Haftar’s efforts to curb radical Islamists while at the same time formally supporting Serraj’s U.N.-recognized government. Serraj is backed emphatically by Italy, the former colonial power that has oil assets in Libya, and Turkey. Qatar, a Gulf rival of the UAE, also supports Serraj. The U.N. envoy to Libya, Ghassan Salame, warned nations tempted to continue supporting Haftar that he was no democrat and his political agenda was not favored by most Libyans. “He is no Abraham Lincoln, he is no big democrat, but he has qualities and wants to unify the country,” Salame told France Inter radio, referring to the U.S. president who steered his country through its Civil War, preserving the union and abolished slavery. Salame said his peacemaking effort was suffering from deep divisions within the U.N. Security Council that led to a British draft resolution on stopping the fighting over Tripoli being blocked last week by Russia and the United States. 