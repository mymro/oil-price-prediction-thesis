Stocks fell on Friday and posted weekly losses as investors digested a slew of corporate earnings reports and remarks from a top Federal Reserve official. The S&P 500 closed 0.6% lower at 2,976.61 while the Nasdaq Composite slid 0.7% to 8,146.49. The Dow Jones Industrial Average fell 68.77 points, or 0.3%, to close at 27,154.20 after rising more than 100 points earlier in the session. The indexes lost most of their earlier gains after Iran said it captured a British oil tanker. For the week, the S&P 500 and Nasdaq fell more than 1% each, notching their biggest weekly loss since late May. The Dow lost 0.6%. The indexes' losses come after reaching all-time highs earlier this week. "This has been a struggle this week," said Dan Deming, managing director at KKM Financial. It feels like the market ran out of momentum after Microsoft released earnings" and New York Fed President John Williams spoke on Thursday. Microsoft shares hit a record after the tech giant posted quarterly earnings and revenue that topped analyst expectations. The company's results were driven by a 39% year-over-year surge in cloud revenue. The stock closed just 0.15% higher, however. American Express, another Dow component, also reported better-than-expected earnings. However, the company's stock dropped more than 2.5%. More than 15% of S&P 500 companies have reported earnings thus far. Of those companies, 79% have posted a better-than-expected profit, according to FactSet data. "So far, there have been no surprises," said Jeff Zipper, managing director of investments at U.S. Bank Private Wealth Management. "Most of the times when the bar is set so low, the results are likely to be in line or slightly better." Entering the earnings season, analysts expected S&P 500 earnings to have fallen by around 3%, according to FactSet data. Next week will be busy for investors as about 25% of the S&P 500 is slated to report quarterly results. "Little is expected from the current earnings season," said Jim Paulsen, chief investment strategist at The Leuthold Group, in a note. However, there are "two favorable aspects impacting corporate profitability which may be underappreciated." "Many believe CEO outlooks have been severely shaken by ongoing uncertainties, but 'behavioral indicators' suggest CEOs remain more confident than perceived," he said. "Second, the economic slowdown this year has produced an overlooked silver lining for earnings—it has enhanced the potential for renewed profit margin expansion as costs across the spectrum (labor, capital and materials cost) have declined." Stocks eked out small gains in the previous session after New York Federal Reserve President John Williams said the central bank needed to "act quickly" when the economy was slowing and rates were low, adding in a speech that it is "better to take preventative measures than wait for disaster to unfold." Those comments led traders to price in a greater possibility that the Fed would cut interest rates by 50 basis points at the end of the month. However, a spokesperson for the New York Fed moved to cool the speculation arising from Williams' comments, telling CNBC that he was drawing from academic research, not hinting at potential policy actions at the upcoming Federal Open Market Committee (FOMC) meeting. "Maybe the New York Fed is walking it back a bit because they don't want to prejudge what will happen at the [July] meeting," said Brent Schutte, chief investment strategist for Northwestern Mutual Wealth Management. "But I believe that if they're going to do it," the Fed should be cutting rates by 50 basis points. "They really need to convince guys like me and the people that control a lot of the money on Wall Street that they are truly serious about reinflating the economy," he said. —CNBC's Elliot Smith contributed to this report.